### **项目需求文档：简约博客与任务管理平台**

#### 1. 项目概述

本项目旨在构建一个风格简约、聚焦内容阅读与效率管理的个人博客平台。后端采用 Java 21 与 Spring Boot 3，前端使用 Vue 3 + Vite，数据库选用 MySQL 8。系统需满足以下要点：
- 访客可自由浏览文章；评论功能需登录后使用。
- 提供一个支持 Markdown 的 TodoList 页面，覆盖每日、每周与每月任务管理。
- 后台管理界面用于文章、评论及任务的日常维护。
- 集成 Spring AI，用于文章智能辅助（如摘要、标题建议）与任务提醒建议。
- 安全方案需自行实现，禁止使用 Spring Security 框架。

#### 2. 核心功能需求

**2.1. 公开访问功能（访客视角）**
- **首页（Home）：** 展示最新文章列表，包含标题、发布日期、标签与摘要，支持分页与标签筛选。
- **文章详情页（Post Detail）：** 显示完整内容、作者信息、AI 生成的推荐阅读/摘要模块。未登录用户可阅读评论但不能发表。
- **TodoList 公共视图（可选）：** 未登录用户可查看示例任务或公开任务板，但不可编辑。

**2.2. 登录后功能（博主/注册用户）**
- **账户体系：** 支持邮箱注册、登录、找回密码。登录状态由自定义 JWT 方案维护（Header 携带 token）。
- **评论体系：** 登录后可对文章发表评论、编辑或删除自己的评论；支持 Markdown 语法与预览。
- **TodoList 管理：**
  - 使用 Markdown 编辑器编写任务内容，工具栏覆盖标题、列表、勾选框、代码块等。
  - 支持按日/周/月视图切换，任务可设定开始时间、到期时间、优先级与完成状态。
  - 可将任务与文章关联，方便跨功能引用。
- **后台管理：**
  - 文章 CRUD 与发布状态管理。
  - 评论审核与屏蔽。
  - TodoList 任务列表、批量更新与归档。
  - AI 模型配置（API Key、提示模板等）。

#### 3. Spring AI 集成需求
- 后端接入 Spring AI，默认支持 OpenAI 兼容模型。
- 文章编辑器中提供“AI 辅助”按钮，可生成标题草案、摘要、标签建议。
- TodoList 支持“AI 生成任务建议”，根据已有任务生成提醒或拆解建议。
- 所有 AI 操作需记录日志（请求提示、响应片段、耗时）。

#### 4. 技术与架构

**后端（backend）：**
- 框架：Spring Boot 3、Spring Web、Spring Data JPA、Spring Validation、Spring AI。
- 安全：自定义认证授权（JWT + Redis 缓存黑名单），不使用 Spring Security。
- 工具：MapStruct（DTO 转换）、Lombok。（后续如需数据库迁移可引入 Flyway）
- 测试：JUnit 5、Spring Boot Test、Testcontainers（MySQL）。

**前端（frontend）：**
- 框架：Vue 3、TypeScript、Vite。
- UI：Tailwind CSS + Headless UI（或自定义组件），支持暗色模式。
- 路由：Vue Router，受保护路由需校验 JWT。
- 状态管理：Pinia。
- Markdown 编辑：使用 `@kangc/v-md-editor` 或 `tiptap`（根据体验选型）。
- 调用层：Axios，统一拦截器处理 token 与错误提示。

#### 5. 数据与数据库
- 使用 MySQL 8，所有表名使用蛇形命名并启用 `utf8mb4` 字符集。
- 关键实体：`users`、`articles`、`article_tags`、`comments`、`todo_items`、`todo_categories`、`todo_links`、`ai_logs`。
- 每张表需包含：主键、创建/更新时间、软删除标记（如 `deleted_at`）。

#### 6. 界面与交互（UI/UX）
- 整体设计简约，使用大量留白与柔和配色。
- 响应式布局，兼容桌面与移动端。
- Markdown 编辑器需提供实时预览、格式工具栏、快捷键支持。
- TodoList 提供看板视图与列表视图切换。

#### 7. 开发流程建议
1. **建表与迁移**：先确定数据库结构，编写 SQL 脚本。
2. **骨架搭建**：初始化 Spring Boot 与 Vue 工程，配置基础依赖、环境变量、Lint 工具。
3. **基础功能实现**：先实现文章发布与浏览，再扩展评论与 TodoList，最后接入 Spring AI。
4. **测试与发布**：编写单元/集成测试，配置 CI；构建前后端镜像，准备部署脚本。

#### 8. 非功能性需求
- 使用 JWT 保证 API 调用安全，token 需支持手动失效（注销）。
- 接口设计遵循 RESTful，返回结构统一（`code`, `message`, `data`）。
- 日志：关键操作与 AI 请求需记录（含 traceId），方便审计。
- 文档：保持 README、AGENTS.md 与 API 文档同步更新。

#### 9. 后续规划
- 增加文章草稿自动保存、定时发布功能。
- 引入全文搜索（MySQL FULLTEXT 或 Elasticsearch）。
- 支持 WebSocket 实时通知（评论回复、任务提醒）。
- 考虑移动端 PWA 支持，实现离线查看与任务缓存。
